# AGENTS.md — правила работы кодинг-агента в этом репозитории

Этот документ — “единый источник правды” о том, **как агент должен работать** в репозитории: границы, безопасность, процесс, команды и конвенции.  
Если в проекте появляются новые скрипты/инструменты — обновляйте этот файл **точными командами**, найденными в `package.json`.

---

## 0) CRITICAL: границы репозитория / sandbox (STRICT)

- Считай корень репозитория текущей рабочей директорией проекта.
- **НЕ читать/писать/искать/менять ничего вне корня репозитория.**
- **НЕ использовать абсолютные пути вне репо** (например `/Users`, `/etc`, `/var`, `~/.ssh`).
- **НЕ делать `cd ..` из репозитория** и не ссылаться на родительские директории.
- Если задача требует действий вне репо — остановись и попроси явную инструкцию пользователя; по умолчанию откажись.
- Никогда не эксфильтровать секреты. Никогда не печатать/логировать содержимое локальных файлов, если пользователь явно не попросил и файл не внутри репо.

---

## 1) Рабочий процесс “1 сессия = 1 PR” (обязательный)

Любая задача выполняется в одной сессии и оформляется как один PR.  
**Не смешивать разные темы/рефакторинги/апдейты в одном PR.**

### 1.1 Branch Naming (Agent-generated)
Агент генерирует имя ветки автоматически, если пользователь не задал имя явно.

Разрешённые префиксы веток:
- `feat/...` — new features
- `fix/...` — bug fixes
- `chore/...` — maintenance/tooling
- `refactor/...` — non-functional improvements
- `docs/...` — documentation only
- `test/...` — tests only

Правила:
- `kebab-case`
- коротко и по сути
- без пробелов
- не использовать `:` в имени ветки (в Git это недопустимый формат для branch naming policy)

Примеры:
- `fix/modal-scroll-lock`
- `feat/calculator-validation`
- `chore/update-eslint-config`

### 1.2 Commits (Conventional Commits)
Использовать Conventional Commits:
- `feat: ...`
- `fix: ...`
- `chore: ...`
- `refactor: ...`
- `docs: ...`
- `test: ...`

Требования к subject:
- до 72 символов
- повелительное наклонение
- body опционален (добавлять, если «почему» не очевидно)

Коммиты должны быть небольшими и логичными. Избегай `wip` в финале (в процессе — по возможности тоже избегать).

**STRICT: No AI attribution footers**
Никогда не добавлять:
- `Co-Authored-By: Codex`
- `Generated with Codex`
- `Generated with...`
- любые аналогичные AI-attribution подписи в commit/PR/issues/docs/выводах

### 1.3 The only allowed change flow
Когда изменения готовы и пользователь явно попросил commit/push/PR:
1) убедиться, что текущая ветка **не** `main`;
2) создать новую ветку (agent-generated name), если нужно;
3) выполнить commit в эту ветку;
4) выполнить push этой ветки;
5) открыть PR.

Одна задача → одна ветка → один PR.

Запрещено пушить в `main` при любом сценарии работы агента.

### 1.4 PR Requirements (Mandatory)
PR-описание должно включать все секции:
- **Summary** — что изменено (bullets)
- **Why** — мотивация/ожидаемое поведение
- **Changes** — ключевые файлы/модули и что сделано
- **How to test** — точные команды и/или ручные шаги + ожидаемый результат
- **Verification** — что из lint/typecheck/tests/build запущено; если не запускалось, почему
- **Screenshots / Video** — для UI-изменений
- **Risk & Rollback** — уровень риска и безопасный способ отката

Агент сначала показывает PR summary в чате, затем создаёт PR и после этого публикует ссылку на PR.

### 1.5 Merging
- Агент **никогда не мержит** PR.
- Решение о merge принимает только пользователь.

---
